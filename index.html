<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Confession</title>
    <style>
        body {
            background-image: url('Background.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-color: pink; /* Fallback color if image fails to load */
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            overflow-x: hidden;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }
        button {
            background-color: #ff69b4;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background-color: #ff1493;
        }
        .heart, .rose {
            position: absolute;
            width: 50px;
            height: 50px;
            animation: floatDown 3s ease-in-out infinite; /* Floats down */
        }
        @keyframes floatDown {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(20px); }
        }
        .present {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            background-color: #ff69b4;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            transition: transform 0.5s;
        }
        .present.open {
            transform: rotateY(180deg) scale(0.8); /* Rotate and shrink to simulate opening into a letter */
        }
        .lid {
            width: 100%;
            height: 50px;
            background-color: #ff1493;
            position: absolute;
            top: 0;
            border-radius: 10px 10px 0 0;
        }
        .box {
            width: 100%;
            height: 150px;
            background-color: #ff69b4;
            position: absolute;
            bottom: 0;
            border-radius: 0 0 10px 10px;
        }
        .present-heart {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            z-index: 1;
        }
        .letter {
            display: none;
            width: 200px; /* Default width, will be overridden dynamically */
            min-height: 200px; /* Minimum height */
            margin: 20px auto;
            background-color: #fff; /* White background */
            border: 2px solid #ff69b4;
            border-radius: 10px;
            position: relative;
            padding: 20px;
            box-sizing: border-box;
            font-family: 'Courier New', monospace; /* Letter-like font */
            text-align: left;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            /* Removed fixed max-height and overflow-y to allow dynamic sizing */
        }
        .letter::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 30px; /* Darker top fold */
            background-color: #f0f0f0; /* Lighter gray for fold */
            border-bottom: 1px solid #ccc;
        }
        .letter-content {
            position: relative;
            z-index: 1;
            padding-top: 40px; /* Space for the fold */
        }
        .letter.show {
            display: block;
        }
        .message {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            margin-top: 20px;
            word-wrap: break-word;
        }
        .message.show {
            display: block;
        }
        #copyLink {
            margin-top: 10px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 15px;
                margin: 10px;
            }
            .heart, .rose {
                width: 30px;
                height: 30px;
            }
            .present {
                width: 150px;
                height: 150px;
            }
            .lid {
                height: 37.5px;
            }
            .box {
                height: 112.5px;
            }
            .present-heart {
                width: 30px;
                height: 30px;
            }
            .letter {
                width: 150px; /* Default for mobile, will be overridden dynamically */
                min-height: 150px;
            }
            button {
                font-size: 14px;
                padding: 8px 16px;
            }
            input, textarea {
                font-size: 14px;
            }
        }
        @media (max-width: 480px) {
            .heart, .rose {
                width: 25px;
                height: 25px;
            }
            .present {
                width: 120px;
                height: 120px;
            }
            .lid {
                height: 30px;
            }
            .box {
                height: 90px;
            }
            .present-heart {
                width: 25px;
                height: 25px;
            }
            .letter {
                width: 120px; /* Default for small mobile, will be overridden dynamically */
                min-height: 120px;
            }
            h1 {
                font-size: 24px;
            }
            .message, .letter {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Create Your Love Confession</h1>
        <form id="confessionForm">
            <input type="text" id="from" placeholder="From (Your Name)" required>
            <input type="text" id="to" placeholder="To (Beloved's Name)" required>
            <textarea id="message" placeholder="Your Message" rows="5" required></textarea>
            <button type="submit">Create Confession</button>
        </form>
        <div id="result" style="display: none;">
            <p>Share this link with your beloved:</p>
            <input type="text" id="shareLink" readonly>
            <button id="copyLink">Copy Link</button>
            <button id="viewConfession">View Confession</button>
            <button id="createAnother">Create Another</button>
        </div>
    </div>

    <!-- Floating Hearts (on creation page) -->
    <img src="heart.png" class="heart" style="left: 10%; animation-delay: 0s;">
    <img src="heart.png" class="heart" style="left: 20%; animation-delay: 1s;">
    <img src="heart.png" class="heart" style="left: 30%; animation-delay: 2s;">
    <img src="heart.png" class="heart" style="left: 40%; animation-delay: 0.5s;">
    <img src="heart.png" class="heart" style="left: 50%; animation-delay: 1.5s;">
    <img src="heart.png" class="heart" style="left: 60%; animation-delay: 2.5s;">
    <img src="heart.png" class="heart" style="left: 70%; animation-delay: 0.2s;">
    <img src="heart.png" class="heart" style="left: 80%; animation-delay: 1.2s;">
    <img src="heart.png" class="heart" style="left: 90%; animation-delay: 2.2s;">

    <!-- Present Box for Viewing -->
    <div id="presentView" style="display: none;">
        <div class="container">
            <h1>A Special Message for You</h1>
            <div class="present" id="presentBox">
                <div class="lid"></div>
                <div class="box"></div>
                <img src="heart2.png" class="present-heart" alt="Heart on Present">
            </div>
            <div class="letter" id="loveLetter">
                <div class="letter-content">
                    <!-- Content will be inserted here -->
                </div>
            </div>
            <div class="message" id="confessionMessage"></div>
        </div>

        <!-- Floating Roses (on letter page, floating down) -->
        <img src="rose.png" class="rose" style="left: 10%; animation-delay: 0s;">
        <img src="rose.png" class="rose" style="left: 20%; animation-delay: 1s;">
        <img src="rose.png" class="rose" style="left: 30%; animation-delay: 2s;">
        <img src="rose.png" class="rose" style="left: 40%; animation-delay: 0.5s;">
        <img src="rose.png" class="rose" style="left: 50%; animation-delay: 1.5s;">
        <img src="rose.png" class="rose" style="left: 60%; animation-delay: 2.5s;">
        <img src="rose.png" class="rose" style="left: 70%; animation-delay: 0.2s;">
        <img src="rose.png" class="rose" style="left: 80%; animation-delay: 1.2s;">
        <img src="rose.png" class="rose" style="left: 90%; animation-delay: 2.2s;">
    </div>

    <script>
        // Hardcode your hosted URL here if needed (e.g., for local testing or embedding)
        // Leave as '' to auto-detect. For production, set to your full URL like 'https://yourusername.github.io/repo/confession.html'
        const baseUrl = '';  // Example: 'https://example.com/confession.html'

        const fromInput = document.getElementById('from');
        const toInput = document.getElementById('to');
        const messageInput = document.getElementById('message');
        const shareLinkInput = document.getElementById('shareLink');
        const resultDiv = document.getElementById('result');

        function generateLink() {
            const from = fromInput.value.trim();
            const to = toInput.value.trim();
            const message = messageInput.value.trim();
            if (from && to && message) {
                const data = btoa(JSON.stringify({ from, to, message }));
                const currentUrl = baseUrl || window.location.href.split('#')[0];
                const link = currentUrl + '#' + data;
                shareLinkInput.value = link;
                resultDiv.style.display = 'block';
            } else {
                resultDiv.style.display = 'none';
            }
        }

        // Generate link on input change
        fromInput.addEventListener('input', generateLink);
        toInput.addEventListener('input', generateLink);
        messageInput.addEventListener('input', generateLink);

        document.getElementById('confessionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            generateLink();  // Ensure it's generated on submit as well
        });

        document.getElementById('copyLink').addEventListener('click', function() {
            shareLinkInput.select();
            document.execCommand('copy');
            alert('Link copied to clipboard!');
        });

        document.getElementById('viewConfession').addEventListener('click', function() {
            const link = shareLinkInput.value;
            if (link) {
                window.open(link, '_blank');
            }
        });

        document.getElementById('createAnother').addEventListener('click', function() {
            // Clear inputs
            fromInput.value = '';
            toInput.value = '';
            messageInput.value = '';
            // Hide result
            resultDiv.style.display = 'none';
            // Refresh the page
            window.location.reload();
        });

        // Check if there's data in URL hash (for viewing)
        if (window.location.hash) {
            try {
                const data = JSON.parse(atob(window.location.hash.substring(1)));
                document.querySelector('.container').style.display = 'none';
                document.getElementById('presentView').style.display = 'block';
                
                const presentBox = document.getElementById('presentBox');
                const letterDiv = document.getElementById('loveLetter');
                const messageDiv = document.getElementById('confessionMessage');
                
                presentBox.addEventListener('click', function() {
                    presentBox.classList.add('open');
                    setTimeout(() => {
                        const letterContent = letterDiv.querySelector('.letter-content');
                        letterContent.innerHTML = `
                            <div style="border-bottom: 1px solid #ff69b4; padding-bottom: 10px; margin-bottom: 10px;">
                                <strong>Dear ${data.to},</strong>
                            </div>
                            <p>${data.message.replace(/\n/g, '<br>')}</p>
                            <div style="text-align: right; margin-top: 20px;">
                                <em>With love,<br>${data.from}</em>
                            </div>
                        `;
                        
                        // Temporarily show to measure dimensions
                        letterDiv.style.display = 'block';
                        letterDiv.style.visibility = 'hidden';
                        
                        // Calculate dynamic width and height
                        const contentWidth = letterContent.scrollWidth;
                        const contentHeight = letterContent.scrollHeight;
                        
                        // Determine max dimensions based on screen size
                        let maxWidth, maxHeight;
                        if (window.innerWidth <= 480) {
                            maxWidth = 120;
                            maxHeight = 400;
                        } else if (window.innerWidth <= 768) {
                            maxWidth = 150;
                            maxHeight = 500;
                        } else {
                            maxWidth = 200;
                            maxHeight = 600;
                        }
                        
                        // Set dynamic width (accounting for padding)
                        const paddingWidth = 40; // 20px left + 20px right
                        letterDiv.style.width = Math.max(100, Math.min(contentWidth + paddingWidth, maxWidth)) + 'px';
                        
                        // Set dynamic height (accounting for padding and fold)
                        const paddingHeight = 80; // Approximate for top padding, fold, etc.
                        const calculatedHeight = contentHeight + paddingHeight;
                        if (calculatedHeight > maxHeight) {
                            letterDiv.style.height = maxHeight + 'px';
                            letterDiv.style.overflowY = 'auto';
                        } else {
                            letterDiv.style.height = calculatedHeight + 'px';
                            letterDiv.style.overflowY = 'visible';
                        }
                        
                        // Now show the letter
                        letterDiv.style.visibility = 'visible';
                        letterDiv.classList.add('show');
                        
                        setTimeout(() => {
                            messageDiv.innerHTML = `<p>ðŸ’Œ A heartfelt confession just for you!</p>`;
                            messageDiv.classList.add('show');
                        }, 1000);
                    }, 500);
                });
            } catch (e) {
                alert('Invalid or corrupted link! Please check the URL.');
            }
        }
    </script>
</body>
</html>

